<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="./css/Chart.css">
    <link rel="stylesheet" type="text/css" href="./css/customChart.css">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
    <script src="./js/Chart.min.js"></script>
    <script src="./js/jquery-3.4.1.min.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/dashDoughnutChart.js"></script>
    <title>대시보드-상품별 도넛차트</title>
</head>
<body>

<div class="chart-container" style="height:193px; width:490px; border: 1px dashed #bcbcbc;">
    <div id="chartContainer" class="float-left" style="width:182px;height:154px;padding: 22px;">

    </div>
    <div class="doughnut-custom-legend float-left" style="width:264px; height:193px ">
        <div id="doughnutLegend" class="chart-legend">
        </div>
    </div>
</div>
<br>
<br>
<button id="randomizeData">데이터 갱신</button>
<script>

    var chartObj = null;

    // 통신 응답 data 가공.
    // 아래 Object로 변형해서 차트로 넘기면 됨.
    // return {labelArr:[], perArr:[], priceArr:[]}
    function reponseData(){
        var totalDataNum = 2 + Math.round(Math.random() * 13);
        var totalPrice = 0;
        var chartData = {};
        chartData.labelArr = [];
        chartData.perArr = [];
        chartData.priceArr = [];
        for(var i=0; i<totalDataNum; i++) {
            chartData.labelArr.push('AWSDatabaseMigrationSvc'+(i+1));
            chartData.priceArr.push(Common.utils.rand(100, 200));
            totalPrice += chartData.priceArr[i];
        }
        for(var j=0; j<totalDataNum; j++) {
            chartData.perArr.push(Math.round((chartData.priceArr[j]/totalPrice)*100));
        }
        return chartData;
    };

    // 필요 없는 부분
    function setButtons(){
        $('#randomizeData').on('click', function() {
            chartObj.update(reponseData());
        });
    };

    function init(){
        setButtons();

        // 차트 인스턴스 생성
        chartObj = new chart.dashDoughnutChart();
        // 차트가 만들어질 div 객체, data를 넘겨줌
        chartObj.init($('#chartContainer'), reponseData(), $('#doughnutLegend'));
        //setLegend();
    };
    window.onload = init;

</script>
</body>
</html>